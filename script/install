#!/bin/bash
set -e

abspath() {
	local path="$1";

	if [[ -d $path ]]; then
		(cd "$path"; pwd -P)
	else
		echo "$path"
	fi
}

inst() {
	src="$1"; shift;
	dst="$1"; shift;
	[ -e "$dst" ] || ln -s "$src" "$dst"
}

SRC="$(abspath $(dirname $(dirname $0)))"
DST="$HOME"

[ ! -d "$DST/.config" ] && mkdir -p "$DST/.config"

inst "$SRC/bash" "$DST/.bash"
inst "$SRC/bashrc" "$DST/.bashrc"
inst "$SRC/gitconfig" "$DST/.gitconfig"
inst "$SRC/gitignore" "$DST/.gitignore"
inst "$SRC/vim" "$DST/.config/nvim"
inst "$SRC/vim" "$DST/.vim"
inst "$SRC/vim/vimrc" "$DST/.vimrc"

### Linux only
if [ "$OSTYPE" == "linux-gnu" ]; then
	[ ! -d "$DST/.config/share" ] && mkdir -p "$DST/.config/share"

	inst "$SRC/Xdefaults" "$DST/.Xdefaults"
	inst "$SRC/autostart" "$DST/.config/autostart"
	inst "$SRC/compton.conf" "$DST/.config/compton.conf"
	inst "$SRC/conky" "$DST/.config/conky"
	inst "$SRC/fontconfig" "$DST/.config/fontconfig"
	inst "$SRC/i3" "$DST/.config/i3"
	inst "$SRC/icons" "$DST/.icons"
	inst "$SRC/mpd" "$DST/.config/mpd"
	inst "$SRC/rofi" "$DST/.config/rofi"
	inst "$SRC/xbindkeysrc" "$DST/.xbindkeysrc"
	inst "$SRC/xprofile" "$DST/.xprofile"
fi

